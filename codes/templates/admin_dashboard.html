<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<nav>
  <div class="nav-container">
    <div class="logo">
      <span class="logo-text">Secure Login System</span>
    </div>
    
    <ul class="nav-links">
      <li><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
    </ul>
  </div>
</nav>
  <div class="admin-container">
    <div class="admin-header">
      <h1><i class="fas fa-users-cog"></i> Admin Dashboard</h1>
      <a href="/logout" class="logout-btn">
        <i class="fas fa-sign-out-alt"></i>
        Logout
      </a>
    </div>

    <div class="admin-card">
      <h2><i class="fas fa-users"></i> Registered Users</h2>
      
      <div class="table-container">
        <div class="table-header">
          <div class="table-cell">Username</div>
          <div class="table-cell">Email</div>
          <div class="table-cell">Role</div>
          <div class="table-cell">Actions</div>
        </div>
        
        {% for user in users %}
        <div class="table-row">
          <div class="table-cell">
            <i class="fas fa-user"></i>
            {{ user.username }}
          </div>
          <div class="table-cell">
            <i class="fas fa-envelope"></i>
            {{ user.email_id }}
          </div>
          <div class="table-cell">
            <span class="role-badge {{ user.role }}">{{ user.role }}</span>
          </div>
          <div class="table-cell actions">
            {% if user.id != current_user_id %}
            <form action="/change_role/{{ user.id }}" method="POST" class="inline-form">
              {% if user.role == 'user' %}
              <input type="hidden" name="role" value="admin">
              <button type="submit" class="btn promote">
                <i class="fas fa-arrow-up"></i>
                Promote
              </button>
              {% else %}
              <input type="hidden" name="role" value="user">
              <button type="submit" class="btn demote">
                <i class="fas fa-arrow-down"></i>
                Demote
              </button>
              {% endif %}
            </form>
            
            <form action="/delete_user/{{ user.id }}" method="POST" class="inline-form">
              <button type="submit" class="btn delete" onclick="return confirm('Are you sure you want to delete this user?')">
                <i class="fas fa-trash"></i>
                Delete
              </button>
            </form>
            {% else %}
            <span class="self-label">Self</span>
            {% endif %}
            
            <a href="/login_activity/{{ user.id }}" class="btn activity">
              <i class="fas fa-history"></i>
              Activity
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const deleteButtons = document.querySelectorAll('.btn.delete');
      deleteButtons.forEach(button => {
        button.addEventListener('click', function(e) {
          if (!confirm('Are you sure you want to delete this user?')) {
            e.preventDefault();
          }
        });
      });
    });
  </script>
</body>
</html>